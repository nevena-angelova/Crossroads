@using Crossroads.Web.Areas.Administration.ViewModels.Users
@using MvcPaging
@model IPagedList<UserViewModel>
@{
    ViewBag.Title = "Потребители";
}

@using (Html.BeginForm("ListUsers", "UsersAdmin", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    <input type="text" name="searchString" />
    <input type="submit" value="Търси" />
}

<table>
    <thead>
        <tr>
            <th></th>
            <th>
                @Html.ActionLink("Име", "ListUsers",
                new { orderBy = "UserName", searchString = ViewBag.SearchString})
            </th>
            <th>Email</th>
            <th>
                @Html.ActionLink("Последна активност", "ListUsers",
                new { orderBy = "LastActionTime", searchString = ViewBag.SearchString })
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @{ int i = 0;
         foreach (var user in Model)
         {
             i++;
            <tr>
                <td>@i</td>
                <td>@Html.ActionLink(user.UserName, "DisplayUser", new { userName = user.UserName })</td>
                <td>@user.Email</td>
                <td>@user.LastActionTime</td>
                <td>
                    @Html.ActionLink("Детайли", "DisplayUser", new { userName = user.UserName })
                </td>
            </tr>
         }

        }
    </tbody>
</table>

<div class="pager">
    @Html.Pager(Model.PageSize, Model.PageNumber, Model.TotalItemCount).Options(o => o
        .AddRouteValue("orderBy", ViewBag.OrderBy)
        .AddRouteValue("searchString", ViewBag.SearchString))
</div>